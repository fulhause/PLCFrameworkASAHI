# PLCFrameworkASAHI

PLCFrameworkASAHI は、IEC61131-3 で定義されたソフトウェアが動作する PLC 上で利用するためのフレームワークをゼロから構築するプロジェクトです。生産設備の設計・開発を効率化し、共通機能を提供することを目的としています。

## プロジェクトの構想

1. **共通ライブラリの整備**  
   デバイス制御、センサ入出力、通信など、PLC アプリケーションで頻出する機能をライブラリ化します。
2. **モジュール化されたアーキテクチャ**  
   機能ごとにモジュールを分割し、再利用しやすい構造を提供します。
3. **デバッグ・シミュレーション支援**  
   実機がなくても動作確認できるよう、シミュレータやテストツールを準備します。

## ロードマップ

| フェーズ | 内容 | 進捗 |
|---------|------|------|
| 0 | リポジトリ初期化、開発方針策定 | ✅ 完了 |
| 1 | 基本ライブラリ設計・実装 | ⬜ 未着手 |
| 2 | モジュール間インターフェース整備 | ⬜ 未着手 |
| 3 | テスト環境・シミュレータ構築 | ⬜ 未着手 |
| 4 | ドキュメント整備・サンプル作成 | ⬜ 未着手 |

## 進捗状況

現在はリポジトリを作成し、ライセンスを追加した段階です。今後、上記ロードマップに沿って開発を進めていく予定です。

## 目的とアーキテクチャ

本フレームワークは、装置開発で頻出する制御ロジックをまとめ、共通化されたモジュールとして提供することを目的としています。PLC プログラムの規模が大きくなると、各機能の実装が分散し保守が困難になります。本プロジェクトでは下記のような階層構造を想定し、役割ごとに部品を分けることで再利用性を高めます。

```
+--------------------------+
|        Application       |
+--------------------------+
        ↑         ↑
   +----+----+ +--+---+
   | Modules | | I/O  |
   +---------+ +------+
```

アプリケーション層は設備固有の制御ロジックを記述し、モジュール層ではサーボモータやインバータ、エアシリンダなど共通機能をまとめたライブラリを提供します。I/O 層にはデバイスドライバや通信処理を配置し、ハードウェア依存部分を隠蔽します。

## TwinCAT プロジェクトへのライブラリ取り込み手順

1. **本リポジトリを取得**
   リリースされた `*.TcLibrary` ファイルをダウンロード、またはソースをクローンしてビルドします。
2. **TwinCAT XAE でプロジェクトを開く**
   メインメニューの `TwinCAT` → `PLC` → `Open` を選択し、既存のプロジェクトまたは新規プロジェクトを準備します。
3. **ライブラリマネージャに追加**
   プロジェクトツリーの `PLC` → `Library Manager` を右クリックし、`Add Library` → `Browse...` を選択して取得した `*.TcLibrary` を指定します。

以上で、ライブラリ内のファンクションブロックやデータ型が使用可能になります。

## サーボモータ・インバータ・エアシリンダの統合例

以下はライブラリを取り込んだ後、アプリケーション側で三つのモジュールを使用する簡単な例です。変数宣言部で各モジュールのファンクションブロックを宣言し、プログラム内で実行します。

```iecst
VAR
    ServoAxis : FB_ServoAxis;   (* サーボモータ制御 *)
    InvAxis   : FB_Inverter;    (* インバータ制御    *)
    Cylinder  : FB_AirCylinder; (* エアシリンダ制御 *)
END_VAR

ServoAxis(bPower := TRUE, fTargetPos := 100.0);
InvAxis(bRun := TRUE, fSpeed := 1500.0);
Cylinder(bExtend := TRUE);
```

各モジュールは適切な初期化処理とパラメータ設定が必要ですが、上記のようにシンプルな呼び出しで動作させることが可能です。具体的なパラメータや拡張機能についてはライブラリ実装が進んだ段階で順次ドキュメントを更新します。

## ライセンス

本プロジェクトは [Apache License 2.0](LICENSE) の下で公開されています。

